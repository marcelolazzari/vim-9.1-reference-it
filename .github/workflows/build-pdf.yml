name: Build PDFs

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Install dependencies
      run: |
        sudo apt-get update -y
        sudo apt-get install -y pandoc texlive-xetex texlive-fonts-recommended texlive-latex-extra fonts-dejavu-core

    - name: Build main PDF
      run: |
        pandoc vim-9.1-reference-it.md -o "Vim-9.1-Reference-IT.pdf" \
          --pdf-engine=xelatex -V geometry:margin=1in -V mainfont="DejaVu Sans Mono" --highlight-style=tango

    - name: Build cheat-sheet PDF
      run: |
        pandoc vim-cheatsheet-it.md -o "Vim-Cheatsheet-IT.pdf" \
          --pdf-engine=xelatex -V geometry:margin=0.7in -V mainfont="DejaVu Sans Mono"

    - name: Upload PDFs as artifact
      uses: actions/upload-artifact@v4
      with:
        name: vim-pdfs
        path: |
          Vim-9.1-Reference-IT.pdf
          Vim-Cheatsheet-IT.pdf
